CREATE OR REPLACE FUNCTION login(
    p_username TEXT,
    p_password TEXT,
    p_user_type TEXT
)
RETURNS TABLE(success BOOLEAN, user_id INT) AS $$
BEGIN
    IF LOWER(p_user_type) = 'customer' THEN
        RETURN QUERY
        SELECT TRUE, customerID
        FROM customer
        WHERE username = p_username AND password = p_password
        LIMIT 1;

        IF NOT FOUND THEN
            RETURN QUERY SELECT FALSE, NULL;
        END IF;

    ELSIF LOWER(p_user_type) = 'staff' THEN
        RETURN QUERY
        SELECT TRUE, staffID
        FROM staff
        WHERE username = p_username AND password = p_password
        LIMIT 1;

        IF NOT FOUND THEN
            RETURN QUERY SELECT FALSE, NULL;
        END IF;

    ELSE
        -- Invalid user_type passed
        RETURN QUERY SELECT FALSE, NULL;
    END IF;
END;
$$ LANGUAGE plpgsql;
